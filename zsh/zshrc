# .zshrc is sourced for interactive shells only
#
# Uncommment this line and the last line in the file to profile startup time
# zmodload zsh/zprof

# Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.zshrc.
# Initialization code that may require console input (password prompts, [y/n]
# confirmations, etc.) must go above this block; everything else may go below.
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

# -- ZSH

# emacs-style keybindings
bindkey -e
# long history
HISTSIZE=1000
SAVEHIST=5000
# additional completions
fpath+=$HOME/.zfunc

# -- Homebrew

if [[ -x /opt/homebrew/bin/brew ]]; then
  eval "$(/opt/homebrew/bin/brew shellenv)"
fi

# -- git

alias gco='git checkout'
alias gb='git branch'
alias gs='git status'

# -- Kubernetes

alias kc='kubectl'

# -- Python

export PYENV_ROOT="$HOME/.pyenv"
export PATH="$PYENV_ROOT/bin:$PATH"
eval "$(pyenv init --path)"

# -- Docker

alias dc="docker-compose -f docker-compose.yml"

# -- Tab completion

ZSH_COMPDUMP="$HOME/.zsh/cache/zcompdump"
zstyle ':completion:*' use-cache on
zstyle ':completion:*' cache-path "$HOME/.zsh/cache"
# Ensure cache directory exists before compinit
mkdir -p "$HOME/.zsh/cache"
# Ensure $fpath is initialized before calling compinit
autoload -Uz compinit
# Use the -C option to enable caching
compinit -C

# -- GPG

export GPG_TTY=$(tty)

# -- direnv

(( $+commands[direnv] )) && eval "$(direnv hook zsh)"

# -- Rippling

export AWS_REGION=us-west-2
export DEVELOPER_NAME=tysonmote
export REMOTE_IP=10.201.8.109
export REMOTE_PRIVATE_KEY_FILE="/Users/tyson/.ssh/id_ed25519"
export SKIP_CHECK_VPN=true
export USE_SSO=true

# -- oh-my-zsh

ZSH=$HOME/.oh-my-zsh
ZSH_THEME="powerlevel10k/powerlevel10k"
DEFAULT_USER=$(whoami)
ENABLE_CORRECTION="false"
DISABLE_MAGIC_FUNCTIONS=true # Don't escape pasted input
SHOW_AWS_PROMPT=false # Don't put AWS info in $RPROMPT
zstyle ':omz:update' mode disabled # Don't check for updates
plugins=(golang pyenv rust)
source $ZSH/oh-my-zsh.sh

# -- fzf

[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh
export FZF_DEFAULT_COMMAND='fd --type f --hidden --follow --exclude .git --exclude vendor'

# To customize prompt, run `p10k configure` or edit ~/.p10k.zsh.
[[ ! -f ~/.p10k.zsh ]] || source ~/.p10k.zsh

# zprof
